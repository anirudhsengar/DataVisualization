<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Assignment 2 - Group 10</title>
  <script src="https://cdn.jsdelivr.net/npm/vega@6.2.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@6.1.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@7.0.2"></script>
  <style>
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
    }
    .header-description {
      text-align: center;
      margin-bottom: 30px;
    }
    .visualization-section {
      margin-bottom: 40px;
      padding: 15px;
      border: 2px solid #e3f8ff;
      text-align: center;
      border-radius: 20px;
      background-color: aliceblue;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Assigment 2 - Group 10</h1>

    <!-- Visualization 1: Day of Week Analysis -->
    <div class="visualization-section">
      <h2>Visualization 1</h2>
      
      <div class="vis-container">
        <div id="vis1"></div>
      </div>
    </div>

    <!-- Visualization 2: Hourly Analysis -->
    <div class="visualization-section">
      <h2>Visualization 2</h2>
      
      <div class="vis-container">
        <div id="vis2"></div>
      </div>
    </div>

    <!-- Visualization 3: Geographic Analysis -->
    <div class="visualization-section">
      <h2>Visualization 3</h2>
      
      <div class="vis-container">
        <div id="vis3"></div>
      </div>
    </div>

    <div class="summary">
      <h2>Summary</h2>

      <h3>Visualization 1</h3>
      <ul>
        <li>Sunday is  a public holiday so it makes sense why the number of accidents recorded on a Sunday are lowest of all the days in the week. All the other days of the week exhibit a very similar trend. It is interesting to note, however, that despite Saturday also being a weekend, the number of accidents recorded is, on average, same to a weekday.</li>
        <li>Even for Sunday, the absolute the number of accidents is still a significant number (~15-20% lower than of a typical weekday) suggesting a widespread issue in dangerous driving habits.</li>
        <li>Properties
          <ol>
            <li>
              <b>Mark</b> - line
            </li>
            <li>
              <b>Channels</b> - Vertical position, Horizontal position & Color hue
            </li>
          </ol>
        </li>
      </ul>

      <h3>Visualization 2</h3>
      <ul>
        <li>The highest number of accidents is recorded around noon hours with the most number of accidents recorded between 1-5pm. The accidents count dips as off-peak hours begin from 8pm onwards and they reach the lowest by 5am after which the morning rush begins and accidents gradually pick up.</li>
        <li>There are several insights one can infer which can help policymakers in implementing solutions to bring down the accidents count:
          <ol>
            <li><b>School Dispersal Time</b> - Around and after noon, buses and private transport students start hitting the road which causes congestion in key arteries and school zone areas, making them prone to accidents. These jams often have spillover effects on to main roads and highways.</li>
            <li><b>Heavy Vehicles</b> - Authorities have already imposed heavy vehicle bans during morning and evening peak hours. However, once the ban is lifted, there is a huge influx of such heavy vehicles causing congestion and accidents.</li>
            <li><b>Overspeeding and Distracted Driving at Free Times</b> - Despite significantly lower cars on the roads at and around midnight, the absolute number of accidents recorded is still high. This is probably due to cars going over the speed limit or distracted driving as a result of "free" roads.</li>
          </ol></li>
        <li>Properties
          <ol>
            <li>
              <b>Mark</b> - bar
            </li>
            <li>
              <b>Channels</b> - Vertical position & Color hue
            </li>
          </ol>
        </li>
      </ul>

      <h3>Visualization 3</h3>
      <ul>
        <li>The highest number of accidents can be seen on the three key arteries of Dubai: E11, E44, E311 and E611. All of the four are main highways of Dubai with the highest footfall of cars.</li>
        <li>A higher density of accidents, otherwise, can be seen in densely populated areas such as Al Nahda, Al Mamzar, Muhaisnah, Al Qusais and other key neighbourhoods and streets bordering with Sharjah.</li>
        <li>Areas close to the Palm Jumeirah have also seen a high number of accidents presumably because of smaller roads.</li>
        <li>Overall, accidents have been recorded even in the remotest areas of Dubai.</li>
        <li>Properties
          <ol>
            <li>
              <b>Mark</b> - point
            </li>
            <li>
              <b>Channels</b> - Vertical position, Horizontal position, size & Color hue
            </li>
          </ol>
        </li>
      </ul>
    </div>

  </div>

  <script>
    // Visualization 1: Day of Week Bar Chart
    const spec1 = {
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "title": "Accident Distribution by Day of the Week",
      "description": "Accident counts from Monday to Sunday",
      "data": {
        "url": "https://raw.githubusercontent.com/sheriefAbdallah/CS318/refs/heads/main/Traffic_Incidents.csv",
        "format": {
          "type": "csv",
          "parse": {"acci_time": "date:'%d/%m/%Y %H:%M:%S'"}
        }
      },
      "width": 980,
      "height": 720,
      "transform": [
        {"calculate": "timeFormat(datum.acci_time, '%A')", "as": "dayOfWeek"},
        {"calculate": "toNumber(timeFormat(datum.acci_time, '%u'))", "as": "dayNum"}
      ],
      "mark": {"type": "bar", "cornerRadius": 6},
      "encoding": {
        "x": {
          "field": "dayOfWeek",
          "type": "ordinal",
          "sort": {"field": "dayNum", "order": "ascending"},
          "axis": {"title": "Day of Week", "labelAngle": 0}
        },
        "y": {
          "aggregate": "count",
          "type": "quantitative",
          "axis": {"title": "Number of Accidents"}
        },
        "color": {
          "field": "dayOfWeek",
          "type": "nominal",
          "scale": {"scheme": "blues"},
          "legend": {"title": "Day"}
        },
        "tooltip": [
          {"field": "dayOfWeek", "type": "nominal", "title": "Day"},
          {"aggregate": "count", "type": "quantitative", "title": "Accidents"}
        ]
      },
      "config": {
        "background": "aliceblue",
        "padding": 20,
        "axis": {"labelFontSize": 12, "titleFontSize": 13},
        "legend": {"labelFontSize": 12, "titleFontSize": 13},
        "title": {"fontSize": 16}
      }
    };

    // Visualization 2: Hourly Line Chart
    const spec2 = {
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "title": "Accident Distribution by Hour of the Day",
      "description": "Hourly accident profile (0â€“23) with a separate line for each weekday",
      "data": {
        "url": "https://raw.githubusercontent.com/sheriefAbdallah/CS318/refs/heads/main/Traffic_Incidents.csv",
        "format": {
          "type": "csv",
          "parse": {"acci_time": "date:'%d/%m/%Y %H:%M:%S'"}
        }
      },
      "width": 980,
      "height": 720,
      "transform": [
        {"calculate": "timeFormat(datum.acci_time, '%A')", "as": "dayOfWeek"},
        {"calculate": "toNumber(timeFormat(datum.acci_time, '%H'))", "as": "hour"}
      ],
      "mark": {
        "type": "line",
        "point": true,
        "interpolate": "monotone",
        "strokeWidth": 2.5
      },
      "encoding": {
        "x": {
          "field": "hour",
          "type": "quantitative",
          "axis": {
            "title": "Hour of Day",
            "values": [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],
            "labelAngle": 0
          },
          "scale": {"domain": [0, 23]}
        },
        "y": {
          "aggregate": "count",
          "type": "quantitative",
          "axis": {"title": "Number of Accidents"}
        },
        "color": {
          "field": "dayOfWeek",
          "type": "nominal",
          "title": "Day of Week",
          "scale": {"scheme": "observable10"}
        },
        "detail": {"field": "dayOfWeek"},
        "tooltip": [
          {"field": "hour", "type": "quantitative", "title": "Hour"},
          {"field": "dayOfWeek", "type": "nominal", "title": "Day"},
          {"aggregate": "count", "type": "quantitative", "title": "Accidents"}
        ]
      },
      "config": {
        "background": "aliceblue",
        "padding": 20,
        "axis": {"labelFontSize": 12, "titleFontSize": 13},
        "legend": {"labelFontSize": 12, "titleFontSize": 13},
        "title": {"fontSize": 16}
      }
    };

    // Visualization 3: Geographic Map
    const spec3 = {
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "title": "Map of Accident Density Across Dubai",
      "width": 980,
      "height": 600,
      "data": {
        "url": "https://raw.githubusercontent.com/sheriefabdallah/CS318/refs/heads/main/Traffic_Incidents.csv",
        "format": {
          "type": "csv",
          "parse": {"acci_time": "date:'%d/%m/%Y %H:%M:%S'"}
        }
      },
      "projection": {"type": "mercator"},
      "transform": [
        {"filter": "datum.acci_y > 23"},
        {
          "aggregate": [{"op": "count", "as": "Accidents"}],
          "groupby": ["acci_x", "acci_y"]
        }
      ],
      "mark": {"type": "circle", "opacity": 0.2, "color": "orange"},
      "encoding": {
        "longitude": {"field": "acci_y", "type": "quantitative"},
        "latitude": {"field": "acci_x", "type": "quantitative"},
        "size": {
          "field": "Accidents",
          "type": "quantitative",
          "scale": {"range": [5, 500]}
        },
        "tooltip": [
          {
            "field": "Accidents",
            "type": "quantitative",
            "title": "Number of Accidents"
          },
          {"field": "acci_x", "type": "quantitative", "title": "Latitude"},
          {"field": "acci_y", "type": "quantitative", "title": "Longitude"}
        ]
      },
      "config": {
        "background": "aliceblue",
        "padding": 20,
        "axis": {"labelFontSize": 12, "titleFontSize": 13},
        "legend": {"labelFontSize": 12, "titleFontSize": 13},
        "title": {"fontSize": 16}
      }
    };

    // Embed all visualizations
    vegaEmbed("#vis1", spec1, {mode: "vega-lite"}).then(console.log).catch(console.warn);
    vegaEmbed("#vis2", spec2, {mode: "vega-lite"}).then(console.log).catch(console.warn);
    vegaEmbed("#vis3", spec3, {mode: "vega-lite"}).then(console.log).catch(console.warn);
  </script>
</body>
</html>
